package ru.rkapp.methods;
import ru.rkapp.ButcherTableMethod;
import ru.rkapp.RightCalculator;

/**
 * Реализация метода Кутты-Нюстрёма 5-го порядка (Kutta-Nyström 5(6) method)
 * для решения дифференциальных уравнений второго порядка вида y'' = f(t, y).
 * 
 * <p>Особенности метода:
 * <ul>
 *   <li>6 стадийный явный метод 5-го порядка</li>
 *   <li>Специализирован для уравнений второго порядка</li>
 *   <li>Оптимизирован для задач небесной механики и физического моделирования</li>
 * </ul>
 * 
 * <p>Таблица Бутчера:
 * <pre>
 *   0   |
 *   1/3 | 1/3
 *   0.4 | 0.16  0.24
 *   1.0 | 0.25 -3.0   3.75
 *   2/3 | 6/81  90/81 -50/81 8/81
 *   0.8 | 6/75  36/75 10/75  8/75  0.0
 * ------+-------------------------------
 *       | 23/192 0.0 125/192 0.0 -81/192 125/192
 * </pre>
 * 
 */
public class CRK5a extends ButcherTableMethod {
    private static final double[] C = {
        1.0/3,     // c2 = 1/3
        0.4,       // c3 = 0.4
        1.0,       // c4 = 1.0
        2.0/3,     // c5 = 2/3
        0.8        // c6 = 0.8
    };
    
    private static final double[] B = {
        23.0/192,  // b1
        0.0,       // b2
        125.0/192, // b3
        0.0,       // b4
        -81.0/192, // b5
        125.0/192  // b6
    };
    
    private static final double[] A = {
        /* Первая строка (i=1): */
        1.0/3,     // a21
        
        /* Вторая строка (i=2): */
        0.16,      // a31
        0.24,      // a32
        
        /* Третья строка (i=3): */
        0.25,      // a41
        -3.0,      // a42
        3.75,      // a43
        
        /* Четвертая строка (i=4): */
        6.0/81,    // a51
        90.0/81,   // a52
        -50.0/81,  // a53
        8.0/81,    // a54
        
        /* Пятая строка (i=5): */
        6.0/75,    // a61
        36.0/75,   // a62
        10.0/75,   // a63
        8.0/75,    // a64
        0.0        // a65
    };
    
    /**
     * Конструктор метода Кутты-Нюстрёма.
     *
     * @param calculator Вычислитель правых частей ОДУ второго порядка (y'' = f(t, y))
     */
    public CRK5a(RightCalculator calculator) {
        super(calculator, C, B, A);
    }
}